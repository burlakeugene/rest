{"version":3,"sources":["webpack:///./src/js/cart.js","webpack:///./src/js/request-package.js","webpack:///./src/js/request.js"],"names":["update","Request","get","url","data","test1","test2","then","resp","html","DOMParser","parseFromString","response","cart","querySelector","oldCart","document","parentNode","replaceChild","add","post","headers","props","config","needAuthorization","hasOwnProperty","authorization","getAuthorization","commonData","middlewares","clearResponse","method","request","self","Promise","resolve","reject","start","xhr","XMLHttpRequest","requestUrl","buildUrl","async","responseType","requestData","responseHeaders","console","log","formData","FormData","Object","keys","forEach","key","append","open","header","setRequestHeader","send","onreadystatechange","readyState","HEADERS_RECEIVED","getAllResponseHeaders","trim","split","headersMap","line","parts","shift","value","join","toLowerCase","setAuthorization","JSON","parse","e","end","length","i","status","base","relative","slice","localStorage","getItem","setItem","removeItem","removeAuthorization","query","body","getAttribute","alert"],"mappings":"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","file":"./js/0.bundle.js","sourcesContent":["import Request from './request';\n\nexport const update = () => {\n  Request.get({\n    url: '/dsds',\n    data: {\n      test1: 'test',\n      test2: 'test',\n    },\n  }).then((resp) => {\n    let html = new DOMParser();\n    html = html.parseFromString(resp.response, 'text/html');\n    let cart = html.querySelector('.cart'),\n      oldCart = document.querySelector('.cart');\n    oldCart.parentNode.replaceChild(cart, oldCart);\n  });\n};\n\nexport const add = (data) => {\n  Request.post({\n    url: '?wc-ajax=add_to_cart',\n    data,\n    headers: {\n      'Content-Type': '',\n    },\n  }).then((resp) => {\n    update();\n  });\n};\n","class Request {\n  constructor(props) {\n    this.config = {\n      url: props.url || '',\n      needAuthorization: props.hasOwnProperty('needAuthorization')\n        ? props.needAuthorization\n        : true,\n      authorization: this.getAuthorization(),\n      commonData: props.hasOwnProperty('commonData') ? props.commonData : {},\n      middlewares: props.middlewares || [],\n      headers: props.hasOwnProperty('headers')\n        ? props.headers\n        : { 'Content-Type': 'application/json' },\n      clearResponse: props.hasOwnProperty('clearResponse')\n        ? props.clearResponse\n        : true,\n    };\n  }\n\n  request(method, request) {\n    let {\n        commonData,\n        headers,\n        needAuthorization,\n        url,\n        middlewares = [],\n        clearResponse,\n      } = this.config,\n      self = this;\n\n    return new Promise((resolve, reject) => {\n      request.start && request.start();\n      let xhr = new XMLHttpRequest();\n      let requestUrl = this.buildUrl(url, request.url);\n      let async = request.async ? request.async : true;\n\n      if (request.responseType) xhr.responseType = request.responseType;\n\n      let requestData = request.data || {};\n      let responseHeaders;\n      requestData = {\n        ...commonData,\n        ...requestData,\n      };\n      headers = { ...headers, ...(request.headers || {}) };\n      if (needAuthorization) {\n        headers['authorization'] = self.getAuthorization();\n      }\n      console.log(headers);\n      if(!headers['Content-Type']) delete headers['Content-Type'];\n      console.log(headers);\n      if(!headers['Content-Type']){\n        let formData = new FormData();\n        Object.keys(requestData).forEach((key) => {\n          formData.append(key, requestData[key]);\n        });\n        requestData = formData;\n      }\n      if (method === 'GET') {\n        requestUrl += '?';\n        for (let data in requestData) {\n          requestUrl += data + '=' + requestData[data] + '&';\n        }\n      }\n\n      xhr.open(method, requestUrl, async);\n      if (needAuthorization) {\n        headers['authorization'] = self.getAuthorization();\n      }\n\n      for (let header in headers) {\n        xhr.setRequestHeader(header, headers[header]);\n      }\n      xhr.send(requestData);\n\n      xhr.onreadystatechange = function () {\n        if (this.readyState === this.HEADERS_RECEIVED) {\n          responseHeaders = xhr\n            .getAllResponseHeaders()\n            .trim()\n            .split(/[\\r\\n]+/);\n          let headersMap = {};\n          responseHeaders.forEach(function (line) {\n            let parts = line.split(': '),\n              header = parts.shift(),\n              value = parts.join(': ');\n            headersMap[header] = value;\n\n            if (\n              (request.hasOwnProperty('needAuthorization')\n                ? request.needAuthorization\n                : needAuthorization) &&\n              header.toLowerCase() === 'authorization'\n            )\n              self.setAuthorization(value);\n          });\n          responseHeaders = headersMap;\n        }\n        if (xhr.readyState !== 4) return;\n        let response = clearResponse ? xhr.response : xhr;\n        try {\n          response = JSON.parse(response);\n        } catch (e) {}\n        request.end && request.end();\n\n        // if (request.responseType === 'blob') {\n        //   response = {\n        //     responseType: 'blob',\n        //     objectURL: URL.createObjectURL(xhr.response),\n        //   };\n        // }\n\n        if (middlewares.length) {\n          for (let i = 0; i <= middlewares.length - 1; i++) {\n            response = middlewares[i](response);\n          }\n        }\n\n        if (xhr.status < 200 || xhr.status > 300) reject(response);\n        else resolve(response);\n      };\n    });\n  }\n\n  buildUrl(base = '', relative = '') {\n    if (base[base.length - 1] === '/' && relative[0] === '/') {\n      base = base.slice(0, base.length - 1);\n    }\n    return base + relative;\n  }\n\n  getAuthorization() {\n    return localStorage.getItem('authorization') || '';\n  }\n\n  setAuthorization(key) {\n    localStorage.setItem('authorization', key);\n  }\n\n  removeAuthorization() {\n    localStorage.removeItem('authorization');\n  }\n\n  logout() {\n    this.removeAuthorization();\n  }\n\n  post(query) {\n    return this.request('POST', query);\n  }\n\n  get(query) {\n    return this.request('GET', query);\n  }\n\n  put(query) {\n    return this.request('PUT', query);\n  }\n\n  delete(query) {\n    return this.request('DELETE', query);\n  }\n\n  patch(query) {\n    return this.request('PATCH', query);\n  }\n}\n\nexport default Request;\n","// import { Request } from 'burlak';\nimport Request from './request-package';\n\nlet body = document.body,\n  url = body ? body.getAttribute('data-home') : '';\n  alert(url)\nconst request = new Request({\n  url\n});\nexport default request;\n"],"sourceRoot":""}